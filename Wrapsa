<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wrapsa Lumpia</title>
  <script defer src="script.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>ðŸŒ¯ Wrapsa</h1>

  <div class="tabs">
    <button onclick="showOrder()">Order Now</button>
    <button onclick="showKitchen()">Kitchen View</button>
  </div>

  <section id="order">
    <h2>Order Now</h2>
    <input id="name" placeholder="Your Name">
    <select id="item">
      <option>Classic Lumpia</option>
      <option>Cheese Lumpia</option>
      <option>Spicy Lumpia</option>
    </select>
    <button onclick="placeOrder()">Place Order</button>
  </section>

  <section id="kitchen" class="hidden">
    <h2>Kitchen View</h2>
    <input id="pin" placeholder="Enter PIN">
    <button onclick="unlockKitchen()">Unlock</button>
    <div id="orders"></div>
  </section>
</body>
</html>

body {
  font-family: Arial, sans-serif;
  background: #fff3e0;
  text-align: center;
  padding: 20px;
}

button {
  padding: 10px;
  margin: 5px;
  background: orange;
  border: none;
  color: white;
  cursor: pointer;
}

.hidden {
  display: none;
}

.order-card {
  background: white;
  margin: 10px auto;
  padding: 10px;
  width: 300px;
}

const PIN = "123PEEPS";
const channel = new BroadcastChannel("wrapsa");

let orders = JSON.parse(localStorage.getItem("orders")) || [];

channel.onmessage = e => {
  orders = e.data;
  renderOrders();
};

function save() {
  localStorage.setItem("orders", JSON.stringify(orders));
  channel.postMessage(orders);
}

function showOrder() {
  order.classList.remove("hidden");
  kitchen.classList.add("hidden");
}

function showKitchen() {
  order.classList.add("hidden");
  kitchen.classList.remove("hidden");
}

function placeOrder() {
  orders.push({
    id: Date.now(),
    name: name.value,
    item: item.value,
    status: "Ordered"
  });
  save();
  alert("Order placed!");
}

function unlockKitchen() {
  if (pin.value === PIN) renderOrders();
  else alert("Wrong PIN");
}

function updateStatus(id, status) {
  if (status === "Complete") {
    orders = orders.filter(o => o.id !== id);
  } else {
    orders.find(o => o.id === id).status = status;
    alert("Order is now " + status);
  }
  save();
}

function renderOrders() {
  ordersDiv.innerHTML = "";
  orders.forEach(o => {
    ordersDiv.innerHTML += `
      <div class="order-card">
        <b>${o.name}</b><br>${o.item}<br>Status: ${o.status}<br>
        <button onclick="updateStatus(${o.id}, 'Preparing')">Preparing</button>
        <button onclick="updateStatus(${o.id}, 'Ready')">Ready</button>
        <button onclick="updateStatus(${o.id}, 'Complete')">Complete</button>
      </div>`;
  });
}
